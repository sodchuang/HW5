# HW5 - Docker Swarm Names Manager 

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°

åŸºæ–¼ HW4 ä¸‰å±¤å¼æ¶æ§‹å»¶ä¼¸ï¼Œå¯¦ä½œ Docker Swarm Manager/Worker åˆ†æ•£å¼éƒ¨ç½²çš„åå­—ç®¡ç†ç³»çµ±ã€‚æ­¤å°ˆæ¡ˆå°ˆæ³¨æ–¼å®¹å™¨ç·¨æ’æŠ€è¡“çš„å­¸ç¿’èˆ‡å¯¦è¸ï¼Œæ¡ç”¨è·¨ç¯€é»çš„æœå‹™åˆ†é›¢æ¶æ§‹ã€‚

### ğŸ¯ å°ˆæ¡ˆç‰¹è‰²
- **Docker Swarm æ¶æ§‹**: Manager èˆ‡ Worker ç¯€é»åˆ†é›¢å¼éƒ¨ç½²
- **è·¨ç¯€é»é€šè¨Š**: ä½¿ç”¨ overlay ç¶²è·¯å¯¦ç¾æœå‹™é–“é€šè¨Š
- **è§’è‰²æ˜ç¢ºåˆ†å·¥**: Manager è² è²¬ Web/APIï¼ŒWorker è² è²¬è³‡æ–™åº«
- **ç”Ÿç”¢ç´šéƒ¨ç½²**: åŒ…å«å¥åº·æª¢æŸ¥ã€è² è¼‰å¹³è¡¡ã€è³‡æ–™æŒä¹…åŒ–
- **Windows ç›¸å®¹**: æ”¯æ´ Windows Docker Desktop ç’°å¢ƒ

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Docker Swarm Cluster                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Overlay Network     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Manager Node    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€ appnet â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚Worker Node â”‚ â”‚
â”‚  â”‚ (å­¸ç”Ÿç­†é›»)       â”‚                         â”‚(å¯¦é©—å®¤æ©Ÿå™¨) â”‚ â”‚
â”‚  â”‚                 â”‚                         â”‚            â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚ â”‚ web:80      â”‚ â”‚                         â”‚ â”‚   db   â”‚ â”‚ â”‚
â”‚  â”‚ â”‚ (Nginx)     â”‚ â”‚                         â”‚ â”‚(Postgres)â”‚â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                         â”‚            â”‚ â”‚
â”‚  â”‚ â”‚ api:8000    â”‚ â”‚                         â”‚            â”‚ â”‚
â”‚  â”‚ â”‚ (FastAPI)   â”‚ â”‚                         â”‚            â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                         â”‚            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Browser      â”‚
    â”‚ http://port:80 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸš€ æŠ€è¡“å †ç–Š

| å±¤ç´š | æŠ€è¡“ | éƒ¨ç½²ä½ç½® | èªªæ˜ |
|------|------|----------|------|
| **å‰ç«¯** | Nginx + HTML/CSS/JS | Manager | éœæ…‹æª”æ¡ˆæœå‹™ + åå‘ä»£ç† |
| **å¾Œç«¯** | FastAPI + Python | Manager | REST API + æ¥­å‹™é‚è¼¯ |
| **è³‡æ–™åº«** | PostgreSQL | Worker | è³‡æ–™æŒä¹…åŒ–å­˜å„² |
| **ç·¨æ’** | Docker Swarm | è·¨ç¯€é» | å®¹å™¨ç·¨æ’èˆ‡æœå‹™ç™¼ç¾ |
| **ç¶²è·¯** | Overlay Network | è·¨ç¯€é» | å®‰å…¨çš„æœå‹™é–“é€šè¨Š |

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
HW5/
â”œâ”€â”€ README.md                    # ä¸»è¦èªªæ˜æ–‡ä»¶ (æœ¬æ–‡ä»¶)
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ EVIDENCE.md             # éƒ¨ç½²é©—è­‰è­‰æ“šæ–‡ä»¶
â”œâ”€â”€ Spec/
â”‚   â”œâ”€â”€ spec.md                 # åŠŸèƒ½è¦æ ¼æ›¸ (å«ç‰ˆæœ¬æ¼”é€²)
â”‚   â””â”€â”€ manager-spec.md         # Manager ç«¯è¦æ ¼
â”œâ”€â”€ manager/                    # Manager ç«¯å¯¦ä½œ
â”‚   â”œâ”€â”€ swarm/
â”‚   â”‚   â””â”€â”€ stack.yaml          # Docker Swarm å †ç–Šé…ç½®
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ app.py              # FastAPI æ‡‰ç”¨ç¨‹å¼
â”‚   â”‚   â”œâ”€â”€ requirements.txt    # Python ç›¸ä¾å¥—ä»¶
â”‚   â”‚   â””â”€â”€ Dockerfile          # API å®¹å™¨æ˜ åƒæª”
â”‚   â”œâ”€â”€ web/
â”‚   â”‚   â”œâ”€â”€ static/
â”‚   â”‚   â”‚   â””â”€â”€ index.html      # å‰ç«¯ä½¿ç”¨è€…ä»‹é¢
â”‚   â”‚   â”œâ”€â”€ nginx.conf          # Nginx é…ç½®æª”
â”‚   â”‚   â””â”€â”€ Dockerfile          # Web å®¹å™¨æ˜ åƒæª”
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â””â”€â”€ init.sql            # è³‡æ–™åº«åˆå§‹åŒ–è…³æœ¬
â”‚   â”œâ”€â”€ deploy.ps1              # è‡ªå‹•éƒ¨ç½²è…³æœ¬
â”‚   â”œâ”€â”€ cleanup.ps1             # ç’°å¢ƒæ¸…ç†è…³æœ¬
â”‚   â”œâ”€â”€ README.md               # Manager ç«¯è©³ç´°èªªæ˜
â”‚   â”œâ”€â”€ MANAGER-README.md       # Manager ç«¯å¿«é€ŸæŒ‡å—
â”‚   â””â”€â”€ QUICKSTART.md           # å¿«é€Ÿé–‹å§‹æŒ‡å—
â”œâ”€â”€ client/                     # å®¢æˆ¶ç«¯ç›¸é—œæª”æ¡ˆ
â””â”€â”€ chat.json                   # é–‹ç™¼éç¨‹è¨è«–ç´€éŒ„
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### åå­—ç®¡ç† (CRUD æ“ä½œ)
- âœ… **æ–°å¢åå­—**: é€é Web ä»‹é¢æˆ– API æ–°å¢åå­—åˆ°è³‡æ–™åº«
- âœ… **åˆ—å‡ºåå­—**: é¡¯ç¤ºæ‰€æœ‰å·²å„²å­˜çš„åå­—åŠå»ºç«‹æ™‚é–“
- âœ… **æ›´æ–°åå­—**: ä¿®æ”¹å·²å­˜åœ¨çš„åå­—è¨˜éŒ„
- âœ… **åˆªé™¤åå­—**: ç§»é™¤ç‰¹å®šçš„åå­—è¨˜éŒ„

### ç³»çµ±åŠŸèƒ½
- âœ… **å¥åº·æª¢æŸ¥**: `/healthz` å’Œ `/api/health` ç«¯é»
- âœ… **API æ–‡ä»¶**: è‡ªå‹•ç”Ÿæˆçš„ Swagger æ–‡ä»¶
- âœ… **éŸ¿æ‡‰å¼è¨­è¨ˆ**: æ”¯æ´æ¡Œé¢å’Œè¡Œå‹•è£ç½®
- âœ… **éŒ¯èª¤è™•ç†**: å®Œæ•´çš„éŒ¯èª¤è™•ç†å’Œä½¿ç”¨è€…å›é¥‹

## ğŸš€ å¿«é€Ÿé–‹å§‹

### å‰ç½®è¦æ±‚

#### Manager ç«¯ (å­¸ç”Ÿç­†é›»)
- Windows 10/11 with WSL2
- Docker Desktop with Swarm mode enabled
- PowerShell 5.1+ æˆ– PowerShell Core
- ç¶²è·¯å­˜å–æ¬Šé™ (é€£æ¥åˆ° Worker ç¯€é»)

#### Worker ç«¯ (å¯¦é©—å®¤æ©Ÿå™¨)
- Linux ç³»çµ± (Ubuntu/CentOS/RHEL)
- Docker Engine 20.10+
- è¶³å¤ çš„å„²å­˜ç©ºé–“ (å»ºè­° 2GB+)
- ç¶²è·¯é€£é€šæ€§ (æ¥å—ä¾†è‡ª Manager çš„é€£æ¥)

### ğŸ”§ å®‰è£èˆ‡éƒ¨ç½²

#### æ­¥é©Ÿ 1: æº–å‚™ Worker ç«¯
```bash
# åœ¨å¯¦é©—å®¤æ©Ÿå™¨ä¸ŠåŸ·è¡Œ
sudo mkdir -p /var/lib/postgres-data
sudo chown 999:999 /var/lib/postgres-data
sudo chmod 755 /var/lib/postgres-data
```

#### æ­¥é©Ÿ 2: åˆå§‹åŒ– Swarm (Manager ç«¯)
```powershell
# åœ¨å­¸ç”Ÿç­†é›»ä¸ŠåŸ·è¡Œ
cd d:\HW5\HW4\HW5\manager
docker swarm init
```

#### æ­¥é©Ÿ 3: åŠ å…¥ Worker ç¯€é»
```bash
# åœ¨å¯¦é©—å®¤æ©Ÿå™¨ä¸ŠåŸ·è¡Œ (ä½¿ç”¨ Manager æä¾›çš„ token)
docker swarm join --token <SWMTKN-xxx> <manager-ip>:2377
```

#### æ­¥é©Ÿ 4: é…ç½®ç¯€é»æ¨™ç±¤
```powershell
# åœ¨ Manager ç«¯åŸ·è¡Œ
docker node ls
docker node update --label-add role=db <worker-node-id>
```

#### æ­¥é©Ÿ 5: ä¸€éµéƒ¨ç½²
```powershell
# åŸ·è¡Œè‡ªå‹•éƒ¨ç½²è…³æœ¬
.\deploy.ps1
```

### ğŸ“Š é©—è­‰éƒ¨ç½²

```powershell
# æª¢æŸ¥ç¯€é»ç‹€æ…‹
docker node ls

# æª¢æŸ¥æœå‹™ç‹€æ…‹
docker service ls
docker stack ps mcapp

# æ¸¬è©¦åŠŸèƒ½
curl http://localhost/              # ä¸»é 
curl http://localhost/api/names     # API
curl http://localhost/healthz       # å¥åº·æª¢æŸ¥
```

é æœŸçµæœ:
- âœ… Manager ç¯€é»é¡¯ç¤ºç‚º Leader
- âœ… Worker ç¯€é»é¡¯ç¤ºç‚º Ready
- âœ… å…©å€‹æœå‹™ (web, api) é‹è¡Œåœ¨ Manager
- âœ… è³‡æ–™åº«æœå‹™é‹è¡Œåœ¨ Worker
- âœ… æ‰€æœ‰å¥åº·æª¢æŸ¥å›å‚³ 200 OK

## ğŸ“ API æ–‡ä»¶

### åŸºæœ¬ç«¯é»

| HTTP æ–¹æ³• | è·¯å¾‘ | èªªæ˜ | ç¯„ä¾‹å›æ‡‰ |
|-----------|------|------|----------|
| `GET` | `/` | ä¸»é é¢ | HTML é é¢ |
| `GET` | `/healthz` | ç°¡å–®å¥åº·æª¢æŸ¥ | `{"status":"ok"}` |
| `GET` | `/api/health` | è©³ç´°å¥åº·æª¢æŸ¥ | `{"status":"ok","database":"connected"}` |
| `GET` | `/api/docs` | API æ–‡ä»¶ (Swagger) | äº’å‹•å¼ API æ–‡ä»¶ |

### åå­—ç®¡ç† API

| HTTP æ–¹æ³• | è·¯å¾‘ | èªªæ˜ | è«‹æ±‚é«” | å›æ‡‰ç¯„ä¾‹ |
|-----------|------|------|--------|----------|
| `GET` | `/api/names` | å–å¾—æ‰€æœ‰åå­— | - | `[{"id":1,"name":"John","created_at":"2025-11-02T..."}]` |
| `POST` | `/api/names` | æ–°å¢åå­— | `{"name":"John"}` | `{"id":1,"name":"John","created_at":"2025-11-02T..."}` |
| `GET` | `/api/names/{id}` | å–å¾—ç‰¹å®šåå­— | - | `{"id":1,"name":"John","created_at":"2025-11-02T..."}` |
| `PUT` | `/api/names/{id}` | æ›´æ–°åå­— | `{"name":"Jane"}` | `{"id":1,"name":"Jane","updated_at":"2025-11-02T..."}` |
| `DELETE` | `/api/names/{id}` | åˆªé™¤åå­— | - | `{"deleted_id":1}` |

### ä½¿ç”¨ç¯„ä¾‹

```bash
# æ–°å¢åå­—
curl -X POST "http://localhost/api/names" \
     -H "Content-Type: application/json" \
     -d '{"name":"Alice"}'

# å–å¾—æ‰€æœ‰åå­—
curl http://localhost/api/names

# åˆªé™¤åå­—
curl -X DELETE http://localhost/api/names/1
```

## ğŸ”§ ç®¡ç†èˆ‡ç¶­è­·

### ç›£æ§æŒ‡ä»¤

```powershell
# æª¢è¦–æœå‹™æ—¥èªŒ
docker service logs -f mcapp-manager_api
docker service logs -f mcapp-manager_web

# æª¢è¦–æœå‹™è©³ç´°ç‹€æ…‹
docker service ps mcapp-manager_api --no-trunc
docker service ps mcapp-manager_web --no-trunc

# æª¢è¦–ç¶²è·¯è³‡è¨Š
docker network ls
docker network inspect appnet
```

### æ“´å±•æœå‹™

```powershell
# æ“´å±• API æœå‹™åˆ° 3 å€‹å‰¯æœ¬
docker service scale mcapp-manager_api=3

# æª¢è¦–æ“´å±•çµæœ
docker service ps mcapp-manager_api
```

### æ›´æ–°æœå‹™

```powershell
# é‡æ–°å»ºç«‹æ˜ åƒæª”
docker build -t mcapp_api:latest ./api/

# æ›´æ–°æœå‹™ (æ»¾å‹•æ›´æ–°)
docker service update mcapp-manager_api
```

### æ¸…ç†ç’°å¢ƒ

```powershell
# ä½¿ç”¨æ¸…ç†è…³æœ¬
.\cleanup.ps1

# æˆ–æ‰‹å‹•æ¸…ç†
docker stack rm mcapp
docker service rm $(docker service ls -q)
docker network prune -f
docker image prune -f
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

#### 1. æœå‹™ç„¡æ³•å•Ÿå‹•
```powershell
# æª¢æŸ¥æœå‹™ç‹€æ…‹å’ŒéŒ¯èª¤è¨Šæ¯
docker service ps mcapp-manager_api --no-trunc
docker service logs mcapp-manager_api

# å¸¸è¦‹åŸå› ï¼š
# - æ˜ åƒæª”å»ºç«‹å¤±æ•—
# - åŸ è™Ÿè¡çª
# - è³‡æºä¸è¶³
```

#### 2. è³‡æ–™åº«é€£ç·šå¤±æ•—
```powershell
# æª¢æŸ¥è³‡æ–™åº«æœå‹™ç‹€æ…‹
docker service ps mcapp_db

# æª¢æŸ¥ç¶²è·¯é€£é€šæ€§
docker network inspect appnet

# å¸¸è¦‹åŸå› ï¼š
# - Worker ç¯€é»é›¢ç·š
# - è³‡æ–™åº«åˆå§‹åŒ–æœªå®Œæˆ
# - ç¶²è·¯é…ç½®éŒ¯èª¤
```

#### 3. ç¶²é ç„¡æ³•å­˜å–
```powershell
# æª¢æŸ¥åŸ è™Ÿæ˜¯å¦è¢«å ç”¨
netstat -an | findstr :80

# æª¢æŸ¥ Nginx é…ç½®
docker service logs mcapp-manager_web

# å¸¸è¦‹åŸå› ï¼š
# - åŸ è™Ÿè¢«å…¶ä»–æœå‹™å ç”¨
# - Nginx é…ç½®éŒ¯èª¤
# - é˜²ç«ç‰†é˜»æ“‹
```

### åµéŒ¯æŠ€å·§

```powershell
# é€²å…¥å®¹å™¨é€²è¡ŒåµéŒ¯
docker exec -it $(docker ps -q -f name=mcapp-manager_api) /bin/bash

# æª¢æŸ¥å®¹å™¨å…§éƒ¨ç¶²è·¯
docker exec $(docker ps -q -f name=mcapp-manager_api) nslookup db

# æª¢æŸ¥è³‡æ–™åº«é€£ç·š
docker exec $(docker ps -q -f name=mcapp-manager_api) python -c "
import psycopg2
conn = psycopg2.connect('postgresql://worker:worker_password@db:5432/worker_names')
print('Database connected successfully!')
"
```

## ğŸ“š æ–‡ä»¶èˆ‡è³‡æº

### å°ˆæ¡ˆæ–‡ä»¶
- ğŸ“– [åŠŸèƒ½è¦æ ¼æ›¸](Spec/spec.md) - å®Œæ•´çš„åŠŸèƒ½éœ€æ±‚å’ŒæŠ€è¡“è¦æ ¼
- ğŸ“‹ [Manager è¦æ ¼](Spec/manager-spec.md) - Manager ç«¯è©³ç´°è¦æ ¼
- ğŸ”§ [Manager èªªæ˜](manager/README.md) - Manager ç«¯è©³ç´°éƒ¨ç½²æŒ‡å—
- âš¡ [å¿«é€Ÿé–‹å§‹](manager/QUICKSTART.md) - å¿«é€Ÿéƒ¨ç½²æŒ‡å—
- ğŸ“Š [éƒ¨ç½²è­‰æ“š](docs/EVIDENCE.md) - å®Œæ•´çš„éƒ¨ç½²é©—è­‰çµæœ

### å¤–éƒ¨è³‡æº
- [Docker Swarm å®˜æ–¹æ–‡ä»¶](https://docs.docker.com/engine/swarm/)
- [FastAPI æ–‡ä»¶](https://fastapi.tiangolo.com/)
- [Nginx é…ç½®æŒ‡å—](https://nginx.org/en/docs/)
- [PostgreSQL å®˜æ–¹æ–‡ä»¶](https://www.postgresql.org/docs/)

## ğŸ“ å­¸ç¿’é‡é»

### Docker Swarm æ¦‚å¿µ
- **ç¯€é»ç®¡ç†**: Manager èˆ‡ Worker ç¯€é»çš„è§’è‰²èˆ‡è·è²¬
- **æœå‹™ç·¨æ’**: é€é stack æª”æ¡ˆå®šç¾©å¤šæœå‹™æ‡‰ç”¨
- **ç¶²è·¯é€šè¨Š**: Overlay ç¶²è·¯å¯¦ç¾è·¨ç¯€é»å®¹å™¨é€šè¨Š
- **è² è¼‰å¹³è¡¡**: Swarm å…§å»ºçš„è² è¼‰å¹³è¡¡æ©Ÿåˆ¶
- **è³‡æ–™æŒä¹…åŒ–**: è·¨ç¯€é»çš„è³‡æ–™å„²å­˜ç­–ç•¥

### å¯¦å‹™æŠ€èƒ½
- Docker Compose èˆ‡ Docker Swarm çš„å·®ç•°
- ç”Ÿç”¢ç’°å¢ƒçš„å®¹å™¨éƒ¨ç½²ç­–ç•¥
- å¾®æœå‹™æ¶æ§‹çš„ç¶²è·¯è¨­è¨ˆ
- å®¹å™¨å¥åº·æª¢æŸ¥èˆ‡ç›£æ§
- åˆ†æ•£å¼ç³»çµ±çš„é™¤éŒ¯æŠ€å·§

### æ¶æ§‹è¨­è¨ˆ
- ä¸‰å±¤å¼æ¶æ§‹åœ¨åˆ†æ•£å¼ç’°å¢ƒçš„å¯¦ä½œ
- æœå‹™åˆ†é›¢èˆ‡è³‡æºæœ€ä½³åŒ–
- å®‰å…¨æ€§è€ƒé‡ (ç¶²è·¯éš”é›¢ã€è³‡æ–™ä¿è­·)
- å¯æ“´å±•æ€§è¨­è¨ˆ (æ©«å‘æ“´å±•ã€è² è¼‰åˆ†æ•£)

## ğŸ”’ å®‰å…¨æ€§è€ƒé‡

### ç¶²è·¯å®‰å…¨
- ä½¿ç”¨ Docker Swarm å…§å»ºçš„åŠ å¯†ç¶²è·¯é€šè¨Š
- é™åˆ¶å°å¤–é–‹æ”¾çš„åŸ è™Ÿ (åƒ… port 80)
- è³‡æ–™åº«åƒ…åœ¨å…§éƒ¨ç¶²è·¯å­˜å–

### è³‡æ–™å®‰å…¨
```yaml
# ç”Ÿç”¢ç’°å¢ƒå»ºè­°ä½¿ç”¨ Docker Secrets
secrets:
  db_password:
    external: true
  
services:
  api:
    secrets:
      - db_password
    environment:
      - DATABASE_PASSWORD_FILE=/run/secrets/db_password
```

### å­˜å–æ§åˆ¶
- è¨­å®šé©ç•¶çš„æª”æ¡ˆæ¬Šé™
- ä½¿ç”¨é root ä½¿ç”¨è€…åŸ·è¡Œå®¹å™¨
- å®šæœŸæ›´æ–°å®¹å™¨æ˜ åƒæª”

## ğŸ“ˆ æ•ˆèƒ½æœ€ä½³åŒ–

### è³‡æºé…ç½®
```yaml
# åœ¨ stack.yaml ä¸­è¨­å®šè³‡æºé™åˆ¶
services:
  api:
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
        reservations:
          cpus: '0.25'
          memory: 256M
```

### æ“´å±•ç­–ç•¥
```powershell
# æ ¹æ“šè² è¼‰å‹•æ…‹èª¿æ•´å‰¯æœ¬æ•¸é‡
docker service scale mcapp-manager_api=3
docker service scale mcapp-manager_web=2
```

### ç›£æ§æŒ‡æ¨™
- è¨˜æ†¶é«”ä½¿ç”¨ç‡
- CPU ä½¿ç”¨ç‡  
- ç¶²è·¯æµé‡
- å›æ‡‰æ™‚é–“
- éŒ¯èª¤ç‡

## ğŸ”„ ç‰ˆæœ¬æ¼”é€²æ­·å²

æœ¬å°ˆæ¡ˆç¶“æ­·äº†å¤šå€‹ç‰ˆæœ¬çš„æ¼”é€²ï¼Œæ¯å€‹ç‰ˆæœ¬éƒ½åœ¨å‰ä¸€ç‰ˆåŸºç¤ä¸Šé€²è¡Œæ”¹é€²ï¼š

| ç‰ˆæœ¬ | ç‰¹è‰² | æŠ€è¡“æ¶æ§‹ |
|------|------|----------|
| **v1.0** | åŸºç¤ä¸‰å±¤æ¶æ§‹ | Docker Compose + SQLite |
| **v2.0** | å®‰å…¨æ€§å¢å¼· | JWT èªè­‰ + ä½¿ç”¨è€…ç³»çµ± |
| **v3.0** | å¤šåŠŸèƒ½æ•´åˆ | PostgreSQL + ä»»å‹™ç®¡ç† |
| **v4.0** | Docker Swarm æ¶æ§‹ (æœ€çµ‚ç‰ˆ) | Manager/Worker åˆ†é›¢éƒ¨ç½² |

> âš ï¸ **é‡è¦æé†’**: è«‹ä»¥æœ€çµ‚ç‰ˆæœ¬ (v4.0) çš„è¦æ ¼å’Œå¯¦ä½œç‚ºæº–ã€‚æ‰€æœ‰çš„ç¨‹å¼ç¢¼ã€é…ç½®æª”æ¡ˆå’Œæ–‡ä»¶éƒ½å·²æ›´æ–°è‡³æœ€çµ‚ç‰ˆæœ¬ã€‚

## ğŸ™ è‡´è¬

æœ¬å°ˆæ¡ˆåŸºæ–¼ HW4 çš„ä¸‰å±¤å¼æ¶æ§‹å»¶ä¼¸é–‹ç™¼ï¼Œæ„Ÿè¬ï¼š
- Docker ç¤¾ç¾¤æä¾›çš„å„ªç§€æ–‡ä»¶å’Œç¯„ä¾‹
- FastAPI æ¡†æ¶çš„ç°¡æ½”è¨­è¨ˆ
- PostgreSQL çš„ç©©å®šå¯é æ€§èƒ½
- å¯¦é©—å®¤ç’°å¢ƒæä¾›çš„æ¸¬è©¦å¹³å°

## ğŸ“ è¯çµ¡è³‡è¨Š

- **å°ˆæ¡ˆä½œè€…**: sodchuang
- **GitHub Repository**: HW4 (with HW5 extension)
- **æŠ€è¡“æ”¯æ´**: é€é GitHub Issues å›å ±å•é¡Œ
- **æ–‡ä»¶ç‰ˆæœ¬**: v4.0 (2025-11-02)

---

**ğŸ¯ å°ˆæ¡ˆç›®æ¨™é”æˆ**: âœ… Docker Swarm Manager/Worker æ¶æ§‹æˆåŠŸå¯¦ä½œä¸¦é©—è­‰é€šéï¼